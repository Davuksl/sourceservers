<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>TF2 Servers</title>

    <!-- TailwindCSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        body { background-color: #0f0f0f; }
    </style>
</head>
<body class="text-gray-100">

<header class="bg-gray-900 py-5 text-center text-3xl font-bold shadow-lg">
    TF2 Server Hub
</header>

<!-- Tabs -->
<div class="flex bg-gray-800 text-gray-300 text-lg">
    <button class="tab px-6 py-3 w-1/3 text-center border-b-4 border-green-500 font-semibold"
            onclick="openTab(0)">TF2 (PC)</button>

    <button class="tab px-6 py-3 w-1/3 text-center border-b-4 border-transparent hover:border-gray-600"
            onclick="openTab(1)">TF2 (Xenia Netplay)</button>

    <button class="tab px-6 py-3 w-1/3 text-center border-b-4 border-transparent hover:border-gray-600"
            onclick="openTab(2)">TF2 (Custom Xenia Server)</button>
</div>

<!-- CONTENT -->
<div class="p-6">

    <!-- PC SERVER -->
    <section class="content">
        <h2 class="text-2xl font-bold mb-4">TF2 (PC) Server</h2>

        <div class="bg-gray-900 rounded-lg p-5 max-w-md shadow-xl">
            <p class="text-lg mb-2"><b>Address:</b> 89.35.130.12:25812</p>

            <a id="connect-btn"
               class="px-4 py-2 rounded-md text-white bg-green-600 hover:bg-green-700 block text-center transition">
                Connect
            </a>

            <p id="tf2-warning" class="text-red-400 mt-3 hidden">
                TF2 is not installed on this PC.
            </p>
        </div>
    </section>

    <!-- XENIA NORMAL -->
    <section class="content hidden">
        <h2 class="text-2xl font-bold mb-4">TF2 (Xenia Netplay)</h2>
        <ul class="list-disc list-inside space-y-2 text-gray-300">
            <li>Open The Orange Box inside Xenia.</li>
            <li>Find the player <b>davuksss</b> in the Netplay menu.</li>
            <li>Join their lobby.</li>
        </ul>
    </section>

    <!-- CUSTOM XENIA -->
    <section class="content hidden">
        <h2 class="text-2xl font-bold mb-4">TF2 (Xenia Custom Server Netplay)</h2>

        <p class="mb-2 font-semibold">Server Status:</p>
        <p id="api-status" class="text-yellow-400 mb-4">Checking...</p>

        <p class="mb-2">Steps:</p>

        <ol class="list-decimal list-inside mb-4 space-y-1">
            <li>Download the custom config:</li>
        </ol>

        <a class="px-4 py-2 rounded-md bg-green-600 hover:bg-green-700 inline-block transition"
           href="http://185.176.94.0:2121/uploads/xenia-canary-netplay.config.toml" download>
            Download Config
        </a>

        <ol start="2" class="list-decimal list-inside mt-4 space-y-1">
            <li>Replace the default <code>xenia-canary-netplay.config.toml</code> file.</li>
            <li>Open Xenia → Netplay menu.</li>
            <li>Set API Address to:<br>
                <b>https://xenia-webservices-6cww.onrender.com/</b></li>
        </ol>
    </section>

</div>

<script>
    /* ----------------------- */
    /* TAB SWITCHER            */
    /* ----------------------- */
    function openTab(i) {
        document.querySelectorAll(".tab").forEach((t, idx) => {
            t.classList.remove("border-green-500");
            t.classList.add("border-transparent");
            if (idx === i) t.classList.add("border-green-500");
        });

        document.querySelectorAll(".content").forEach((c, idx) => {
            c.classList.toggle("hidden", idx !== i);
        });
    }

    /* ----------------------- */
    /* SAFE TF2 DETECT (NO AUTO OPEN STEAM) */
    /* ----------------------- */
    async function checkTF2Installed() {
        // Просто проверяем вызов steam:// — НЕ открывает приложение
        return new Promise(resolve => {
            let test = document.createElement("a");
            test.href = "steam://rungameid/440";

            // Если браузер разрешает протокол → игра установлена
            if (test.protocol === "steam:") {
                resolve(true);
            } else {
                resolve(false);
            }
        });
    }

    async function updateSteamStatus() {
        const installed = await checkTF2Installed();

        const btn = document.getElementById("connect-btn");
        const warn = document.getElementById("tf2-warning");

        if (installed) {
            btn.href = "steam://connect/89.35.130.12:25812";
            btn.classList.remove("opacity-40", "cursor-not-allowed");
            warn.classList.add("hidden");
        } else {
            btn.href = "#";
            btn.classList.add("opacity-40", "cursor-not-allowed");
            warn.classList.remove("hidden");
        }
    }

    updateSteamStatus();


    /* ----------------------- */
    /* CUSTOM API STATUS CHECK */
    /* ----------------------- */
    async function checkCustomAPI() {
        const statusEl = document.getElementById("api-status");

        try {
            const res = await fetch("https://xenia-webservices-6cww.onrender.com/", { method: "GET" });

            if (res.ok) {
                statusEl.textContent = "Online";
                statusEl.classList.remove("text-red-400", "text-yellow-400");
                statusEl.classList.add("text-green-400");
            } else {
                statusEl.textContent = "Offline";
                statusEl.classList.remove("text-green-400", "text-yellow-400");
                statusEl.classList.add("text-red-400");
            }
        } catch {
            statusEl.textContent = "Offline";
            statusEl.classList.remove("text-green-400", "text-yellow-400");
            statusEl.classList.add("text-red-400");
        }
    }

    checkCustomAPI();
</script>

</body>
</html>
